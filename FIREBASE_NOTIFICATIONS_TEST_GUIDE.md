# ุฏููู ุงุฎุชุจุงุฑ ุฅุดุนุงุฑุงุช Firebase ุนูู Android

## ๐ ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ

### 1. ุงูุชุญูู ูู ุฅุนุฏุงุฏุงุช Android

ุชุฃูุฏ ูู ุฃู:
- โ `google-services.json` ููุฌูุฏ ูู `android/app/`
- โ Google Services plugin ููุถุงู ูู `android/build.gradle.kts` ู `android/app/build.gradle.kts`
- โ Firebase project ููุนุฏ ุจุดูู ุตุญูุญ

### 2. ุชุดุบูู ุงูุชุทุจูู ุนูู Android

```bash
# ุนุฑุถ ุงูุฃุฌูุฒุฉ ุงููุชุงุญุฉ
flutter devices

# ุชุดุบูู ุนูู Android
flutter run -d <device_id>

# ุฃู ูุจุงุดุฑุฉ
flutter run
```

---

## ๐งช ุทุฑููุฉ 1: ุงุฎุชุจุงุฑ ูู Firebase Console (ุงูุฃุณูู)

### ุงูุฎุทูุงุช:

1. **ุงูุชุญ Firebase Console**
   - ุงุฐูุจ ุฅูู: https://console.firebase.google.com/
   - ุงุฎุชุฑ ูุดุฑูุนู: `shs-app-c66a7`

2. **ุงุฐูุจ ุฅูู Cloud Messaging**
   - ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ: **Engage** โ **Cloud Messaging**
   - ุฃู ูุจุงุดุฑุฉ: https://console.firebase.google.com/project/shs-app-c66a7/messaging

3. **ุฅูุดุงุก ุฅุดุนุงุฑ ุชุฌุฑูุจู**
   - ุงุถุบุท ุนูู **"Send your first message"** ุฃู **"New campaign"**
   - ุงุฎุชุฑ **"Firebase Notification messages"**
   - ุฃุฏุฎู:
     - **Notification title**: "ุงุฎุชุจุงุฑ ุฅุดุนุงุฑ"
     - **Notification text**: "ูุฐุง ุฅุดุนุงุฑ ุชุฌุฑูุจู ูู Firebase"
   - ุงุถุบุท **"Send test message"**

4. **ุฅุฏุฎุงู FCM Token**
   - ุงูุชุญ ุงูุชุทุจูู ุนูู Android
   - ุงูุชุญ Console/Logs
   - ุงุจุญุซ ุนู: `โ FCM Token: [token]`
   - ุงูุณุฎ ุงูู token
   - ุงูุตูู ูู Firebase Console
   - ุงุถุบุท **"Test"**

5. **ุงููุชูุฌุฉ ุงููุชููุนุฉ**
   - โ ูุฌุจ ุฃู ูุธูุฑ ุงูุฅุดุนุงุฑ ุนูู ุงูุฌูุงุฒ
   - โ ูู Console: `๐จ ุฅุดุนุงุฑ ุฌุฏูุฏ: ุงุฎุชุจุงุฑ ุฅุดุนุงุฑ`

---

## ๐งช ุทุฑููุฉ 2: ุงุฎุชุจุงุฑ ูู ุงูุชุทุจูู ููุณู (ุฅุดุนุงุฑ ูุญูู)

### ุงุณุชุฎุฏุงู ุดุงุดุฉ ุงูุฅุนุฏุงุฏุงุช:

1. **ุงูุชุญ ุงูุชุทุจูู**
2. **ุณุฌู ุงูุฏุฎูู** (ุฃู ุฏูุฑ)
3. **ุงุฐูุจ ุฅูู ุงูุฅุนุฏุงุฏุงุช**
4. **ุงุจุญุซ ุนู ูุณู "ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช"**
5. **ุงุถุบุท ุนูู "ุฅุฑุณุงู ุฅุดุนุงุฑ ุชุฌุฑูุจู"**

### ุฃู ูู ุฎูุงู Console:

ุงูุชุญ Flutter DevTools ุฃู Terminal ูุงูุชุจ:

```dart
// ูู Flutter DevTools Console
NotificationService().showTestNotification();
```

---

## ๐งช ุทุฑููุฉ 3: ุงุฎุชุจุงุฑ ูู ุงูุณูุฑูุฑ (Backend)

### ุงูุฎุทูุงุช:

1. **ุชุฃูุฏ ุฃู ุงูุณูุฑูุฑ ูุนูู**
   ```bash
   cd server
   dart run lib/main.dart
   ```

2. **ุงุญุตู ุนูู FCM Token**
   - ุงูุชุญ ุงูุชุทุจูู ุนูู Android
   - ุณุฌู ุงูุฏุฎูู
   - ุงูุชุญ Console ูุงุจุญุซ ุนู: `โ FCM Token: [token]`
   - ุงูุณุฎ ุงูู token

3. **ุงุญูุธ FCM Token ูู ุงูุณูุฑูุฑ**
   ```bash
   curl -X POST http://localhost:8080/api/users/<userId>/fcm-token \
     -H "Content-Type: application/json" \
     -d '{"token": "YOUR_FCM_TOKEN_HERE"}'
   ```

4. **ุฃุฑุณู ุฅุดุนุงุฑ ูู ุงูุณูุฑูุฑ**
   ```bash
   curl -X POST http://localhost:8080/api/notifications/send-fcm \
     -H "Content-Type: application/json" \
     -d '{
       "userId": "YOUR_USER_ID",
       "title": "ุฅุดุนุงุฑ ูู ุงูุณูุฑูุฑ",
       "message": "ูุฐุง ุฅุดุนุงุฑ ุชุฌุฑูุจู ูู ุงูุณูุฑูุฑ",
       "data": {"type": "test", "id": "123"}
     }'
   ```

   **ููุงุญุธุฉ**: ุญุงููุงู ูุฐุง ูุญูุธ ุงูุฅุดุนุงุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุท. ูุฅุฑุณุงู ูุนููุ ูุฌุจ ุฅุถุงูุฉ Firebase Admin SDK.

---

## ๐ ุงูุชุญูู ูู ุฃู ูู ุดูุก ูุนูู

### 1. ุงูุชุญูู ูู ุชููุฆุฉ Firebase

ุงูุชุญ Console/Logs ูุงุจุญุซ ุนู:

```
โ Firebase initialized successfully on android
โ Firebase Messaging initialized successfully
โ FCM Token: [token]
โ ุชู ุญูุธ FCM Token ูุญููุงู
```

### 2. ุงูุชุญูู ูู ุงูุตูุงุญูุงุช

- โ ูุฌุจ ุฃู ูุทูุจ ุงูุชุทุจูู ุตูุงุญูุงุช ุงูุฅุดุนุงุฑุงุช ุนูุฏ ุฃูู ุชุดุบูู
- โ ูู Console: `Firebase permissions: AuthorizationStatus.authorized`

### 3. ุงุฎุชุจุงุฑ ุงูุญุงูุงุช ุงููุฎุชููุฉ

#### ุฃ. ุงูุชุทุจูู ููุชูุญ (Foreground)
- ุฃุฑุณู ุฅุดุนุงุฑ ูู Firebase Console
- **ุงููุชูุฌุฉ ุงููุชููุนุฉ**: 
  - โ ูุธูุฑ ุงูุฅุดุนุงุฑ ูู ุงูุชุทุจูู
  - โ ูู Console: `๐จ ุฅุดุนุงุฑ ุฌุฏูุฏ: [title]`

#### ุจ. ุงูุชุทุจูู ูู ุงูุฎูููุฉ (Background)
- ุงูุชุญ ุงูุชุทุจูู
- ุงุถุบุท ุฒุฑ Home (ุฃู ุงูุชุจุฏูู ุจูู ุงูุชุทุจููุงุช)
- ุฃุฑุณู ุฅุดุนุงุฑ ูู Firebase Console
- **ุงููุชูุฌุฉ ุงููุชููุนุฉ**:
  - โ ูุธูุฑ ุงูุฅุดุนุงุฑ ูู ุดุฑูุท ุงูุฅุดุนุงุฑุงุช
  - โ ุนูุฏ ุงูููุฑ: ููุชุญ ุงูุชุทุจูู
  - โ ูู Console: `๐ ุชู ูุชุญ ุงูุฅุดุนุงุฑ: [data]`

#### ุฌ. ุงูุชุทุจูู ูุบูู (Terminated)
- ุฃุบูู ุงูุชุทุจูู ุชูุงูุงู
- ุฃุฑุณู ุฅุดุนุงุฑ ูู Firebase Console
- **ุงููุชูุฌุฉ ุงููุชููุนุฉ**:
  - โ ูุธูุฑ ุงูุฅุดุนุงุฑ ูู ุดุฑูุท ุงูุฅุดุนุงุฑุงุช
  - โ ุนูุฏ ุงูููุฑ: ููุชุญ ุงูุชุทุจูู
  - โ ุนูุฏ ูุชุญ ุงูุชุทุจูู: ูู Console: `ูุนุงูุฌุฉ ุงูุชููู: [data]`

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ 1: ูุง ูุธูุฑ FCM Token

**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
- Firebase ุบูุฑ ููููุฃ ุจุดูู ุตุญูุญ
- `google-services.json` ุบูุฑ ููุฌูุฏ ุฃู ุฎุงุทุฆ
- ูุดููุฉ ูู ุงูุงุชุตุงู ุจุงูุฅูุชุฑูุช

**ุงูุญู:**
1. ุชุญูู ูู `google-services.json` ูู `android/app/`
2. ุชุฃูุฏ ูู ุฃู `package_name` ูู `google-services.json` ูุทุงุจู `applicationId` ูู `build.gradle.kts`
3. ูู ุจู `flutter clean` ุซู `flutter pub get` ุซู `flutter run`

### ุงููุดููุฉ 2: ุงูุฅุดุนุงุฑุงุช ูุง ุชุธูุฑ

**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
- ุตูุงุญูุงุช ุงูุฅุดุนุงุฑุงุช ุบูุฑ ููุนุทุงุฉ
- ููุงุฉ ุงูุฅุดุนุงุฑุงุช ุบูุฑ ููุนุฏุฉ ุจุดูู ุตุญูุญ (Android 8.0+)
- FCM Token ุบูุฑ ุตุญูุญ

**ุงูุญู:**
1. ุงุฐูุจ ุฅูู ุฅุนุฏุงุฏุงุช Android โ ุงูุชุทุจููุงุช โ shs_app โ ุงูุฅุดุนุงุฑุงุช
2. ุชุฃูุฏ ูู ุชูุนูู ุงูุฅุดุนุงุฑุงุช
3. ุชุญูู ูู Console ููุฃุฎุทุงุก

### ุงููุดููุฉ 3: "Firebase Messaging ุบูุฑ ูุชุงุญ"

**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
- ูุดููุฉ ูู ุชููุฆุฉ Firebase
- ูุดููุฉ ูู ุงูุงุชุตุงู ุจุงูุฅูุชุฑูุช

**ุงูุญู:**
1. ุชุญูู ูู ุงุชุตุงู ุงูุฅูุชุฑูุช
2. ุชุญูู ูู `firebase_options.dart`
3. ุชุฃูุฏ ูู ุฃู Firebase project ููุฌูุฏ ููุณููุญ ุจู

---

## ๐ฑ ุงุฎุชุจุงุฑ ุณุฑูุน (Quick Test)

### ุณูุฑูุจุช ุงุฎุชุจุงุฑ ุณุฑูุน:

1. **ุดุบู ุงูุชุทุจูู ุนูู Android**
2. **ุณุฌู ุงูุฏุฎูู**
3. **ุงูุชุญ Console**
4. **ุงุจุญุซ ุนู FCM Token**
5. **ุงูุชุญ Firebase Console โ Cloud Messaging โ Send test message**
6. **ุงูุตู ุงูู token ูุฃุฑุณู ุฅุดุนุงุฑ**
7. **ุชุญูู ูู ุธููุฑ ุงูุฅุดุนุงุฑ**

---

## โ ูุงุฆูุฉ ุงูุชุญูู (Checklist)

- [ ] Firebase project ููุนุฏ
- [ ] `google-services.json` ููุฌูุฏ
- [ ] Google Services plugin ููุถุงู
- [ ] ุงูุชุทุจูู ูุนูู ุนูู Android
- [ ] FCM Token ูุธูุฑ ูู Console
- [ ] ุตูุงุญูุงุช ุงูุฅุดุนุงุฑุงุช ููุนุทุงุฉ
- [ ] ุฅุดุนุงุฑ ุชุฌุฑูุจู ูู Firebase Console ูุนูู
- [ ] ุงูุฅุดุนุงุฑุงุช ุชุธูุฑ ูู ุฌููุน ุงูุญุงูุงุช (ููุชูุญ/ุฎูููุฉ/ูุบูู)

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

ุจุนุฏ ุงูุชุฃูุฏ ูู ุฃู ุงูุฅุดุนุงุฑุงุช ุชุนูู:

1. **ุฅุถุงูุฉ Firebase Admin SDK ูู ุงูุณูุฑูุฑ** ูุฅุฑุณุงู ุฅุดุนุงุฑุงุช ูู ุงูููุฏ
2. **ุฅุถุงูุฉ ููุทู ุงูุชููู** ุนูุฏ ุงูููุฑ ุนูู ุงูุฅุดุนุงุฑุงุช
3. **ุฅุถุงูุฉ ุฃููุงุน ุฅุดุนุงุฑุงุช ูุฎุชููุฉ** (ููุงุนูุฏุ ูุตูุงุชุ ุฅูุฎ)
4. **ุฅุถุงูุฉ ุฅุดุนุงุฑุงุช ูุฌุฏููุฉ** (ุชุฐููุฑ ุงูุฃุฏููุฉ)

---

## ๐ ูุฑุงุฌุน

- [Firebase Cloud Messaging Documentation](https://firebase.google.com/docs/cloud-messaging)
- [Flutter Firebase Messaging Package](https://pub.dev/packages/firebase_messaging)
- [Firebase Console](https://console.firebase.google.com/)

